#!/bin/sh
# shellcheck disable=SC1091

# Borrar todos los metadatos EXIF de una carpeta con imágenes

. "$HOME/.dotfiles/assets/shell/shell-utils-sh"

IMAGE_DIR="$1"
init_log exif_remove >/dev/null

if [ ! -d "$IMAGE_DIR" ]; then
	log "El directorio no existe: $IMAGE_DIR"
	exit 1
fi

find "$IMAGE_DIR" -type f -iname "*.jpg" -o -iname "*.jpeg" -o -iname "*.png" -o -iname "*.gif" -o -iname "*.bmp" | while read -r IMAGE; do
	if exiftool -overwrite_original_in_place -all= "$IMAGE" >/dev/null 2>&1; then
		print_msg "Metadatos EXIF eliminados con éxito de: $IMAGE"
	else
		log "Error al eliminar metadatos EXIF de: $IMAGE" WARN
	fi
done
